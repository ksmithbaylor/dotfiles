#!/bin/bash

function colorize() {
  currency=$1
  color=$2
  value=$(echo -ne $3 | xargs printf $4)

  echo "#[fg=$color] $currency $5$value"
}

function btc() {
  value=$(curl -s https://api.exchange.coinbase.com/products/BTC-USD/ticker | jq -r .bid)

  printf "$(colorize "BTC" "colour208" $value '%0.0f' '$')"
}

function eth() {
  value=$(curl -s https://api.exchange.coinbase.com/products/ETH-USD/ticker | jq -r .bid)

  printf "$(colorize "ETH" "colour69" $value '%0.0f' '$')"
}

function sol() {
  value=$(curl -s https://api.exchange.coinbase.com/products/SOL-USD/ticker | jq -r .bid)

  printf "$(colorize "SOL" "colour37" $value '%0.0f' '$')"
}

function ethbtc() {
  value=$(curl -s https://api.exchange.coinbase.com/products/ETH-BTC/ticker | jq -r .bid)

  printf "$(colorize "E/B" "colour244" $value '%0.4f' '')"
}

function soleth() {
  value=$(curl -s https://api.exchange.coinbase.com/products/SOL-ETH/ticker | jq -r .bid)

  printf "$(colorize "S/E" "colour241" $value '%0.4f' '')"
}

function coin() {
  value=$(curl -s 'https://query2.finance.yahoo.com/v8/finance/chart/COIN' | jq '.chart.result[0].indicators.quote[0].close | last * 100 | round / 100')
  # value=$(curl -s https://query1.finance.yahoo.com/v6/finance/quoteSummary/coin?modules=financialData | jq -r '.quoteSummary.result[0].financialData.currentPrice.fmt')

  printf "$(colorize "COIN" "colour33" $value '%0.2f' '$')"
  if [[ -f ~/.private/enabled ]] && [[ -f ~/.private/tmux-tickers ]]; then
    ~/.private/tmux-tickers $value
  fi
}

function tickers() {
  btc
  eth
  sol
  ethbtc
  soleth
  # coin
}

tickers
